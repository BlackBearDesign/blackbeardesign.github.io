<!doctype html>
<html lang="en">
  <head>
    <title>BlackBear | Journal</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link rel="stylesheet" href="css/vendor/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    
    <style>
      /* Estilos para mantener la estética BlackBear */
      body { background-color: #000; color: #fff; }
      .post-content { color: #ccc; line-height: 1.8; }
      .post-content img { width: 100%; border-radius: 10px; margin: 30px 0; object-fit: cover; }
      
      .navigation-post p { color: #fff; font-weight: bold; margin-top: 5px; }
      .navigation-post span { color: #ef3159; text-transform: uppercase; font-size: 12px; letter-spacing: 2px; }
      
      .comment-v1 { border-bottom: 1px solid #222; padding: 25px 0; }
      .comment-v1 h3 { color: #ef3159; font-size: 18px; margin-bottom: 5px; }
      .comment-date { font-size: 12px; color: #666; margin-bottom: 15px; }
      
      .form-control { background: #111; border: 1px solid #333; color: #fff; }
      .form-control:focus { background: #151515; color: #fff; border-color: #ef3159; }
    </style>
  </head>
  <body>

    <div class="unslate_co--site-wrap">
      <div class="unslate_co--site-inner">

        <div class="cover-v1 jarallax overlay" id="post-header" style="background-color: #111; height: 70vh;">
          <div class="container">
            <div class="row align-items-center justify-content-center" style="height: 70vh;">
              <div class="col-md-10 text-center">
                <h1 class="blog-heading" id="post-title">Cargando...</h1>
                <div class="post-meta" id="post-meta"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="unslate_co--section">
          <div class="container">
            <div class="row justify-content-center">
              <div class="col-md-8 post-content" id="post-content"></div>
            </div>

            <div class="row mt-5 pt-5 navigation-post border-top border-dark">
              <div class="col-6">
                <a href="#" id="prev-link" class="d-block">
                  <span>&larr; Previous Post</span>
                  <p id="prev-title">...</p>
                </a>
              </div>
              <div class="col-6 text-right">
                <a href="#" id="next-link" class="d-block">
                  <span>Next Post &rarr;</span>
                  <p id="next-title">...</p>
                </a>
              </div>
            </div>

            <div class="row justify-content-center mt-5 pt-5">
              <div class="col-md-8">
                <h3 class="mb-5" id="comment-count">0 Comments</h3>
                <ul class="comment-list" id="dynamic-comments"></ul>

                <div class="comment-form-wrap pt-5">
                  <h3 class="mb-5">Leave a comment</h3>
                  <form id="commentForm" class="p-5 bg-black border border-dark">
                    <div class="form-group">
                      <label for="name">Name *</label>
                      <input type="text" class="form-control" id="name" required>
                    </div>
                    <div class="form-group">
                      <label for="message">Message *</label>
                      <textarea id="message" cols="30" rows="5" class="form-control" required></textarea>
                    </div>
                    <div class="form-group">
                      <input type="submit" value="Post Comment" class="btn btn-outline-pill btn-custom-light" id="submitBtn">
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <script>
      // CONFIGURACIÓN DE LINKS
      const URL_POSTS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSBApKJcrHq_sBa2EA4YDyj4GeFrGJ-uH6HzYjGaMbw_tQAIg1Ll6h_w42HbyC2Wuz5uVIDAG0nvbo0/pub?gid=0&single=true&output=csv";
      const URL_COMENTARIOS = "PON_AQUI_TU_CSV_DE_LA_PESTAÑA_COMENTARIOS";
      const URL_APPS_SCRIPT = "https://script.google.com/macros/s/AKfycby1w3WCAhLKvRlppqqnwf4TLyb8yCVcz6KXxnsO-gwsz_wJqb1Dj7a4vbQISltivviqzA/exec";

      const params = new URLSearchParams(window.location.search);
      const postID = parseInt(params.get('id')) || 1;

      // 1. CARGAR CONTENIDO Y NAVEGACIÓN
      Papa.parse(URL_POSTS, {
        download: true, header: true,
        complete: function(res) {
          const posts = res.data.filter(p => p.ID);
          const post = posts.find(p => p.ID == postID) || posts[0];

          document.getElementById('post-title').innerText = post.Titulo;
          document.getElementById('post-meta').innerText = `By ${post.Autor} • ${post.Fecha} • ${post.TiempoLectura}`;
          document.getElementById('post-content').innerHTML = post.Contenido;
          document.getElementById('post-header').style.backgroundImage = `url('${post.ImagenPortada}')`;

          // Lógica Circular
          let idx = posts.findIndex(p => p.ID == postID);
          let prev = posts[(idx - 1 + posts.length) % posts.length];
          let next = posts[(idx + 1) % posts.length];

          document.getElementById('prev-link').href = `blog-single.html?id=${prev.ID}`;
          document.getElementById('prev-title').innerText = prev.Titulo;
          document.getElementById('next-link').href = `blog-single.html?id=${next.ID}`;
          document.getElementById('next-title').innerText = next.Titulo;
        }
      });

      // 2. CARGAR COMENTARIOS LINEALES
      Papa.parse(URL_COMENTARIOS, {
        download: true, header: true,
        complete: function(res) {
          const comments = res.data.filter(c => c.PostID == postID);
          document.getElementById('comment-count').innerText = `${comments.length} Comments`;
          let html = "";
          comments.forEach(c => {
            html += `<li class="comment-v1"><h3>${c.Nombre}</h3><div class="comment-date">${c.Fecha}</div><p>${c

  </body>
</html>
